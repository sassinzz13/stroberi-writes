{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/components/ViewContents/ViewContents.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"articleActions\": \"ViewContents-module__FSKH0G__articleActions\",\n  \"articleContainer\": \"ViewContents-module__FSKH0G__articleContainer\",\n  \"articleContent\": \"ViewContents-module__FSKH0G__articleContent\",\n  \"comment\": \"ViewContents-module__FSKH0G__comment\",\n  \"commentActions\": \"ViewContents-module__FSKH0G__commentActions\",\n  \"commentAuthor\": \"ViewContents-module__FSKH0G__commentAuthor\",\n  \"commentForm\": \"ViewContents-module__FSKH0G__commentForm\",\n  \"commentTime\": \"ViewContents-module__FSKH0G__commentTime\",\n  \"delete\": \"ViewContents-module__FSKH0G__delete\",\n  \"deleteButton\": \"ViewContents-module__FSKH0G__deleteButton\",\n  \"edit\": \"ViewContents-module__FSKH0G__edit\",\n  \"editButton\": \"ViewContents-module__FSKH0G__editButton\",\n  \"editTextarea\": \"ViewContents-module__FSKH0G__editTextarea\",\n  \"image\": \"ViewContents-module__FSKH0G__image\",\n  \"imageWrapper\": \"ViewContents-module__FSKH0G__imageWrapper\",\n  \"ql-editor\": \"ViewContents-module__FSKH0G__ql-editor\",\n  \"replies\": \"ViewContents-module__FSKH0G__replies\",\n  \"title\": \"ViewContents-module__FSKH0G__title\",\n  \"wrapper\": \"ViewContents-module__FSKH0G__wrapper\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 29, "column": 0}, "map": {"version":3,"sources":["file:///home/sassinzz13/programming-portfolio/stroberi-writes/client/src/components/ViewContents/ViewContents.jsx"],"sourcesContent":["\"use client\";\nimport React, { useEffect, useState, useContext } from \"react\";\nimport Image from \"next/image\";\nimport styles from \"../ViewContents/ViewContents.module.css\";\nimport { AuthContext } from \"@/context/AuthContext\";\nimport { useParams, useRouter } from \"next/navigation\";\nimport parse from \"html-react-parser\";\nimport \"quill/dist/quill.snow.css\";\n\nconst ViewContents = () => {\n  const { year, month, day, slug } = useParams();\n  const { isLoggedIn, isSuperuser, user, loadingUser } =\n    useContext(AuthContext);\n  const router = useRouter();\n\n  const [post, setPost] = useState(null);\n  const [comments, setComments] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [newComment, setNewComment] = useState({ body: \"\" });\n  const [editingCommentId, setEditingCommentId] = useState(null);\n  const [editingCommentBody, setEditingCommentBody] = useState(\"\");\n  const [postingComment, setPostingComment] = useState(false);\n\n  // Fetch post and comments\n  useEffect(() => {\n    const fetchPost = async () => {\n      try {\n        const url = `http://127.0.0.1:8000/api/blog/posts/${year}/${month}/${day}/${slug}/`;\n        const res = await fetch(url);\n        if (!res.ok) throw new Error(`Failed to fetch post: ${res.status}`);\n        const data = await res.json();\n        setPost(data.post);\n        setComments(data.comments || []);\n      } catch (err) {\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchPost();\n  }, [year, month, day, slug]);\n\n  // ===== COMMENTS =====\n  const handleCommentChange = (e) =>\n    setNewComment({ ...newComment, [e.target.name]: e.target.value });\n\n  const handleCommentSubmit = async (e) => {\n    e.preventDefault();\n    if (!post) return;\n    setPostingComment(true);\n    try {\n      const token = localStorage.getItem(\"accessToken\");\n      const res = await fetch(\n        `http://127.0.0.1:8000/api/blog/posts/${post.id}/comment/`,\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${token}`,\n          },\n          body: JSON.stringify({ body: newComment.body }),\n        }\n      );\n      if (!res.ok) throw new Error(`Failed to post comment: ${res.status}`);\n      const savedComment = await res.json();\n      setComments([savedComment, ...comments]);\n      setNewComment({ body: \"\" });\n    } catch (err) {\n      console.error(err);\n    } finally {\n      setPostingComment(false);\n    }\n  };\n\n  const handleEditClick = (comment) => {\n    setEditingCommentId(comment.id);\n    setEditingCommentBody(comment.body);\n  };\n\n  const handleEditChange = (e) => setEditingCommentBody(e.target.value);\n\n  const handleEditSubmit = async (commentId) => {\n    try {\n      const token = localStorage.getItem(\"accessToken\");\n      const res = await fetch(\n        `http://127.0.0.1:8000/api/blog/comments/${commentId}/edit/`,\n        {\n          method: \"PUT\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${token}`,\n          },\n          body: JSON.stringify({ body: editingCommentBody }),\n        }\n      );\n      if (!res.ok) throw new Error(`Failed to edit comment: ${res.status}`);\n      const updatedComment = await res.json();\n      setComments(\n        comments.map((c) => (c.id === commentId ? updatedComment : c))\n      );\n      setEditingCommentId(null);\n      setEditingCommentBody(\"\");\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  const handleDeleteComment = async (commentId) => {\n    try {\n      const token = localStorage.getItem(\"accessToken\");\n      const res = await fetch(\n        `http://127.0.0.1:8000/api/blog/comments/${commentId}/delete/`,\n        {\n          method: \"DELETE\",\n          headers: { Authorization: `Bearer ${token}` },\n        }\n      );\n      if (!res.ok) throw new Error(`Failed to delete comment: ${res.status}`);\n      setComments(comments.filter((c) => c.id !== commentId));\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  // ===== POST DELETE =====\n  const handleDeletePost = async () => {\n    if (!confirm(\"Are you sure you want to delete this post?\")) return;\n    try {\n      const token = localStorage.getItem(\"accessToken\");\n      const res = await fetch(\n        `http://127.0.0.1:8000/api/blog/posts/${post.id}/delete/`,\n        {\n          method: \"DELETE\",\n          headers: { Authorization: `Bearer ${token}` },\n        }\n      );\n      if (!res.ok) throw new Error(`Failed to delete post: ${res.status}`);\n      alert(\"Post deleted!\");\n      router.push(\"/\");\n    } catch (err) {\n      console.error(err);\n      alert(\"Failed to delete post.\");\n    }\n  };\n\n  if (loading || loadingUser) return <p>Loading...</p>;\n  if (error) return <p>Error: {error}</p>;\n  if (!post) return <p>Post not found</p>;\n\n  return (\n    <div className={styles.wrapper}>\n      <div className={styles.articleContainer}>\n        <h1 className={styles.title}>{post.title}</h1>\n\n        {post.image && (\n          <div className={styles.imageWrapper}>\n            <Image\n              src={`https://res.cloudinary.com/dwdhdzva8/${post.image}`}\n              alt={post.title}\n              fill\n              className={styles.image}\n              sizes=\"(max-width: 1200px) 100vw, 1200px\"\n              priority\n            />\n          </div>\n        )}\n\n        <div className={styles.articleContent}>\n          <div className=\"ql-editor\">\n            {post.body ? parse(post.body) : <p>No content available.</p>}\n          </div>\n        </div>\n\n        {/* ===== SUPERUSER POST ACTIONS ===== */}\n        {isLoggedIn && isSuperuser && (\n          <div className={styles.articleActions}>\n            <button\n              className={styles.editButton}\n              onClick={() => {\n                router.push(`/edit-post/${year}/${month}/${day}/${slug}`);\n              }}\n            >\n              Edit Post\n            </button>\n            <button className={styles.deleteButton} onClick={handleDeletePost}>\n              Delete Post\n            </button>\n          </div>\n        )}\n\n        {/* ===== COMMENTS ===== */}\n        <div className={styles.commentsSection}>\n          <h2>Comments</h2>\n\n          {isLoggedIn ? (\n            <form onSubmit={handleCommentSubmit} className={styles.commentForm}>\n              <textarea\n                name=\"body\"\n                placeholder=\"Add a comment...\"\n                value={newComment.body}\n                onChange={handleCommentChange}\n                required\n              />\n              <button type=\"submit\" disabled={postingComment}>\n                {postingComment ? \"Posting...\" : \"Post Comment\"}\n              </button>\n            </form>\n          ) : (\n            <p>You must be logged in to post a comment.</p>\n          )}\n\n          <div className={styles.commentList}>\n            {comments.length === 0 ? (\n              <p>No comments yet.</p>\n            ) : (\n              comments.map((comment) => (\n                <div key={comment.id} className={styles.comment}>\n                  <p className={styles.commentAuthor}>\n                    {comment.user || \"Anonymous\"}:\n                  </p>\n\n                  {editingCommentId === comment.id ? (\n                    <>\n                      <textarea\n                        value={editingCommentBody}\n                        onChange={handleEditChange}\n                        className={styles.editTextarea}\n                      />\n                      <button onClick={() => handleEditSubmit(comment.id)}>\n                        Save\n                      </button>\n                      <button onClick={() => setEditingCommentId(null)}>\n                        Cancel\n                      </button>\n                    </>\n                  ) : (\n                    <p>{comment.body}</p>\n                  )}\n\n                  {comment.user === user?.username &&\n                    editingCommentId !== comment.id && (\n                      <div className={styles.commentActions}>\n                        <button onClick={() => handleEditClick(comment)}>\n                          Edit\n                        </button>\n                        <button onClick={() => handleDeleteComment(comment.id)}>\n                          Delete\n                        </button>\n                      </div>\n                    )}\n                </div>\n              ))\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ViewContents;\n"],"names":[],"mappings":"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","debugId":null}}]
}